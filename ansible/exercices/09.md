
---

## ğŸ§ª Objectif du TP sur les tags

- Ajouter des `tags` Ã  des tÃ¢ches
- Utiliser les options `--tags`, `--skip-tags`, `--step`, `--start-at-task`
- Tester les `tags` spÃ©ciaux (`always`, `never`)
- ContrÃ´ler lâ€™exÃ©cution dâ€™un playbook via les tags

---

## ğŸ“ Fichier dâ€™inventaire `hosts`

Utilisez ce fichier (ou adaptez si vous en avez dÃ©jÃ  un similaire) :

```ini
[control]
ubuntu-c ansible_connection=local

[centos]
centos1 ansible_port=2222
centos[2:3]

[centos:vars]
ansible_user=root

[ubuntu]
ubuntu[1:3]

[ubuntu:vars]
ansible_become=true
ansible_become_pass=password

[linux:children]
centos
ubuntu
```

---

## ğŸ§© Playbook `tags_demo.yml`

```yaml
- name: TP - Utilisation des tags avec Ansible
  hosts: linux
  become: true
  gather_facts: false

  tasks:

    - name: TÃ¢che toujours exÃ©cutÃ©e
      debug:
        msg: "Ceci est une tÃ¢che toujours exÃ©cutÃ©e"
      tags: always

    - name: TÃ¢che 1 - Install paquet fictif
      debug:
        msg: "Installation du paquet nginx"
      tags: install

    - name: TÃ¢che 2 - Configuration de service
      debug:
        msg: "Configuration du service"
      tags: config

    - name: TÃ¢che 3 - RedÃ©marrage service
      debug:
        msg: "RedÃ©marrage du service"
      tags: restart

    - name: TÃ¢che jamais exÃ©cutÃ©e par dÃ©faut
      debug:
        msg: "TÃ¢che jamais exÃ©cutÃ©e sauf si explicitement appelÃ©e"
      tags: never
```

---

## â–¶ï¸ Ã‰tapes de test

### 1. Lancer toutes les tÃ¢ches normalement

```bash
ansible-playbook -i hosts tags_demo.yml
```

### 2. Lancer uniquement la tÃ¢che de configuration

```bash
ansible-playbook -i hosts tags_demo.yml --tags config
```

### 3. Lancer toutes sauf les redÃ©marrages

```bash
ansible-playbook -i hosts tags_demo.yml --skip-tags restart
```

### 4. Forcer lâ€™exÃ©cution de la tÃ¢che `never`

```bash
ansible-playbook -i hosts tags_demo.yml --tags never
```

---

## âš™ï¸ Bonus : InteractivitÃ© avec `--step`

```bash
ansible-playbook -i hosts tags_demo.yml --step
```

ğŸ‘‰ Cela permet de valider chaque tÃ¢che manuellement.

---

## ğŸ¯ Relancer Ã  une tÃ¢che spÃ©cifique avec `--start-at-task`

```bash
ansible-playbook -i hosts tags_demo.yml --start-at-task "TÃ¢che 3 - RedÃ©marrage service"
```

